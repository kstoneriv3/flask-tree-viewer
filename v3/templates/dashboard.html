<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <title>Job Dashboard</title>
    <!-- Using a local copy or a CDN; adjust if offline -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootswatch@5.2.3/dist/cosmo/bootstrap.min.css">
    <style>
      body {
        padding: 20px;
      }
      #sidebar {
        border-right: 1px solid #ddd;
        padding-right: 20px;
      }
      #tree ul {
        list-style-type: none;
        padding-left: 15px;
      }
      #tree li {
        margin: 4px 0;
      }
      #tree li.selected > span {
        background-color: #e0e0e0;
        border-radius: 4px;
      }
    </style>
  </head>
  <body>
    <div class="container-fluid">
      <div class="row">
        <!-- Sidebar with tree visualization -->
        <div id="sidebar" class="col-md-4">
          <h2>Job Tree</h2>
          <div id="tree">
            {{ tree_html|safe }}
          </div>
        </div>
        <!-- Main area: node details -->
        <div id="main-content" class="col-md-8">
          <h2>Node Details</h2>
          <div id="nodeDetails">
            <p>Select a node from the tree to view its properties.</p>
          </div>
        </div>
      </div>
    </div>
    <script>
      // Updated selectNode function accepts the event object
      function selectNode(event, element) {
        // Stop the click event from bubbling up to parent nodes
        event.stopPropagation();

        // Remove "selected" from any other nodes
        const currentlySelected = document.querySelectorAll('#tree li.selected');
        currentlySelected.forEach(function(el) {
          el.classList.remove('selected');
        });
        
        // Mark the clicked node as selected
        element.classList.add('selected');
        
        // Read data attributes from the clicked element
        var name = element.getAttribute("data-name");
        var status = element.getAttribute("data-status");
        var numdesc = element.getAttribute("data-numdesc");
        var nodetype = element.getAttribute("data-nodetype");
        
        // Build the HTML to display node details
        var detailsHTML = "<ul class='list-group'>";
        detailsHTML += "<li class='list-group-item'><strong>Name:</strong> " + name + "</li>";
        detailsHTML += "<li class='list-group-item'><strong>Status:</strong> " + status + "</li>";
        detailsHTML += "<li class='list-group-item'><strong>Number of Descendants:</strong> " + numdesc + "</li>";
        detailsHTML += "<li class='list-group-item'><strong>Node Type:</strong> " + nodetype + "</li>";
        detailsHTML += "</ul>";
        
        // Update the nodeDetails div with the details
        document.getElementById("nodeDetails").innerHTML = detailsHTML;
      }
    </script>
  </body>
</html>

